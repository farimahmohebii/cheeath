Number of CPU cores: 4
Using Eigen for Matmul
Doing BaseOT ...
using kkot pack
using kkot pack
using kkot pack
using kkot pack
After one-time setup, communication
Thread i = 0, total data sent till now = 184970
Thread i = 1, total data sent till now = 294765
Thread i = 2, total data sent till now = 163141
Thread i = 3, total data sent till now = 294765
-----------Syncronizing-----------
secret_share_mod: 137352314881 bitlength: 37
backend: PrimeField-OT-SCI_HE
-----------Syncronized - now starting execution-----------
Starting fused batchNorm #1
Time in sec for current BN = [0.154] sent [2.37732] MB
Truncate #1 on 150528 points by 12 bits
Conv2DCSF 1 called N=1, H=226, W=226, CI=3, FH=3, FW=3, CO=24, S=2
Time in sec for current conv = 15.281
Relu #1 on 301056 points, truncate=1 by 12 bits
Time in sec for current relu = 2.617
Maxpool 1 called N=1, H=56, W=56, C=24, ksizeH=3, ksizeW=3
Time in sec for current maxpool = 4.649
Conv2DCSF 2 called N=1, H=56, W=56, CI=24, FH=1, FW=1, CO=58, S=1
Time in sec for current conv = 0.548
Relu #3 on 181888 points, truncate=1 by 12 bits
Time in sec for current relu = 1.453
Conv2DCSF 3 called N=1, H=58, W=58, CI=58, FH=3, FW=3, CO=58, S=2
Time in sec for current conv = 2.859
Truncate #2 on 45472 points by 12 bits
Conv2DCSF 4 called N=1, H=28, W=28, CI=58, FH=1, FW=1, CO=58, S=1
Time in sec for current conv = 0.36
Conv2DCSF 5 called N=1, H=58, W=58, CI=24, FH=3, FW=3, CO=24, S=2
Time in sec for current conv = 0.552
Truncate #3 on 18816 points by 12 bits
Conv2DCSF 6 called N=1, H=28, W=28, CI=24, FH=1, FW=1, CO=58, S=1
Time in sec for current conv = 0.19
Truncate #4 on 45472 points by 12 bits
Truncate #5 on 45472 points by 12 bits
Relu #5 on 90944 points, truncate=0 by 0 bits
Time in sec for current relu = 0.701
Conv2DCSF 7 called N=1, H=28, W=28, CI=58, FH=1, FW=1, CO=58, S=1
Time in sec for current conv = 0.363
Relu #7 on 45472 points, truncate=1 by 12 bits
Time in sec for current relu = 0.36
Conv2DCSF 8 called N=1, H=30, W=30, CI=58, FH=3, FW=3, CO=58, S=1
Time in sec for current conv = 2.604
Truncate #6 on 45472 points by 12 bits
Conv2DCSF 9 called N=1, H=28, W=28, CI=58, FH=1, FW=1, CO=58, S=1
Time in sec for current conv = 0.364
Relu #9 on 45472 points, truncate=1 by 12 bits
Time in sec for current relu = 0.359
Conv2DCSF 10 called N=1, H=28, W=28, CI=58, FH=1, FW=1, CO=58, S=1
Time in sec for current conv = 0.364
Relu #11 on 45472 points, truncate=1 by 12 bits
Time in sec for current relu = 0.358
Conv2DCSF 11 called N=1, H=30, W=30, CI=58, FH=3, FW=3, CO=58, S=1
Time in sec for current conv = 2.497
Truncate #7 on 45472 points by 12 bits
Conv2DCSF 12 called N=1, H=28, W=28, CI=58, FH=1, FW=1, CO=58, S=1
Time in sec for current conv = 0.364
Relu #13 on 45472 points, truncate=1 by 12 bits
Time in sec for current relu = 0.357
Conv2DCSF 13 called N=1, H=28, W=28, CI=58, FH=1, FW=1, CO=58, S=1
Time in sec for current conv = 0.367
Relu #15 on 45472 points, truncate=1 by 12 bits
Time in sec for current relu = 0.358
Conv2DCSF 14 called N=1, H=30, W=30, CI=58, FH=3, FW=3, CO=58, S=1
Time in sec for current conv = 2.524
Truncate #8 on 45472 points by 12 bits
Conv2DCSF 15 called N=1, H=28, W=28, CI=58, FH=1, FW=1, CO=58, S=1
Time in sec for current conv = 0.356
Relu #17 on 45472 points, truncate=1 by 12 bits
Time in sec for current relu = 0.358
Conv2DCSF 16 called N=1, H=28, W=28, CI=116, FH=1, FW=1, CO=116, S=1
Time in sec for current conv = 1.089
Relu #19 on 90944 points, truncate=1 by 12 bits
Time in sec for current relu = 0.748
Conv2DCSF 17 called N=1, H=30, W=30, CI=116, FH=3, FW=3, CO=116, S=2
Time in sec for current conv = 3.034
Truncate #9 on 22736 points by 12 bits
Conv2DCSF 18 called N=1, H=14, W=14, CI=116, FH=1, FW=1, CO=116, S=1
Time in sec for current conv = 0.42
Conv2DCSF 19 called N=1, H=30, W=30, CI=116, FH=3, FW=3, CO=116, S=2
Time in sec for current conv = 2.983
Truncate #10 on 22736 points by 12 bits
Conv2DCSF 20 called N=1, H=14, W=14, CI=116, FH=1, FW=1, CO=116, S=1
Time in sec for current conv = 0.43
Truncate #11 on 22736 points by 12 bits
Truncate #12 on 22736 points by 12 bits
Relu #21 on 45472 points, truncate=0 by 0 bits
Time in sec for current relu = 0.342
Conv2DCSF 21 called N=1, H=14, W=14, CI=116, FH=1, FW=1, CO=116, S=1
Time in sec for current conv = 0.429
Relu #23 on 22736 points, truncate=1 by 12 bits
Time in sec for current relu = 0.19
Conv2DCSF 22 called N=1, H=16, W=16, CI=116, FH=3, FW=3, CO=116, S=1
Time in sec for current conv = 2.471
Truncate #13 on 22736 points by 12 bits
Conv2DCSF 23 called N=1, H=14, W=14, CI=116, FH=1, FW=1, CO=116, S=1
Time in sec for current conv = 0.428
Relu #25 on 22736 points, truncate=1 by 12 bits
Time in sec for current relu = 0.185
Conv2DCSF 24 called N=1, H=14, W=14, CI=116, FH=1, FW=1, CO=116, S=1
Time in sec for current conv = 0.439
Relu #27 on 22736 points, truncate=1 by 12 bits
Time in sec for current relu = 0.188
Conv2DCSF 25 called N=1, H=16, W=16, CI=116, FH=3, FW=3, CO=116, S=1
Time in sec for current conv = 2.516
Truncate #14 on 22736 points by 12 bits
Conv2DCSF 26 called N=1, H=14, W=14, CI=116, FH=1, FW=1, CO=116, S=1
Time in sec for current conv = 0.431
Relu #29 on 22736 points, truncate=1 by 12 bits
Time in sec for current relu = 0.188
Conv2DCSF 27 called N=1, H=14, W=14, CI=116, FH=1, FW=1, CO=116, S=1
Time in sec for current conv = 0.426
Relu #31 on 22736 points, truncate=1 by 12 bits
Time in sec for current relu = 0.189
Conv2DCSF 28 called N=1, H=16, W=16, CI=116, FH=3, FW=3, CO=116, S=1
Time in sec for current conv = 2.407
Truncate #15 on 22736 points by 12 bits
Conv2DCSF 29 called N=1, H=14, W=14, CI=116, FH=1, FW=1, CO=116, S=1
Time in sec for current conv = 0.43
Relu #33 on 22736 points, truncate=1 by 12 bits
Time in sec for current relu = 0.188
Conv2DCSF 30 called N=1, H=14, W=14, CI=116, FH=1, FW=1, CO=116, S=1
Time in sec for current conv = 0.431
Relu #35 on 22736 points, truncate=1 by 12 bits
Time in sec for current relu = 0.188
Conv2DCSF 31 called N=1, H=16, W=16, CI=116, FH=3, FW=3, CO=116, S=1
Time in sec for current conv = 2.527
Truncate #16 on 22736 points by 12 bits
Conv2DCSF 32 called N=1, H=14, W=14, CI=116, FH=1, FW=1, CO=116, S=1
Time in sec for current conv = 0.426
Relu #37 on 22736 points, truncate=1 by 12 bits
Time in sec for current relu = 0.191
Conv2DCSF 33 called N=1, H=14, W=14, CI=116, FH=1, FW=1, CO=116, S=1
Time in sec for current conv = 0.438
Relu #39 on 22736 points, truncate=1 by 12 bits
Time in sec for current relu = 0.188
Conv2DCSF 34 called N=1, H=16, W=16, CI=116, FH=3, FW=3, CO=116, S=1
Time in sec for current conv = 2.521
Truncate #17 on 22736 points by 12 bits
Conv2DCSF 35 called N=1, H=14, W=14, CI=116, FH=1, FW=1, CO=116, S=1
Time in sec for current conv = 0.426
Relu #41 on 22736 points, truncate=1 by 12 bits
Time in sec for current relu = 0.189
Conv2DCSF 36 called N=1, H=14, W=14, CI=116, FH=1, FW=1, CO=116, S=1
Time in sec for current conv = 0.426
Relu #43 on 22736 points, truncate=1 by 12 bits
Time in sec for current relu = 0.202
Conv2DCSF 37 called N=1, H=16, W=16, CI=116, FH=3, FW=3, CO=116, S=1
Time in sec for current conv = 1.936
Truncate #18 on 22736 points by 12 bits
Conv2DCSF 38 called N=1, H=14, W=14, CI=116, FH=1, FW=1, CO=116, S=1
Time in sec for current conv = 0.429
Relu #45 on 22736 points, truncate=1 by 12 bits
Time in sec for current relu = 0.19
Conv2DCSF 39 called N=1, H=14, W=14, CI=116, FH=1, FW=1, CO=116, S=1
Time in sec for current conv = 0.423
Relu #47 on 22736 points, truncate=1 by 12 bits
Time in sec for current relu = 0.188
Conv2DCSF 40 called N=1, H=16, W=16, CI=116, FH=3, FW=3, CO=116, S=1
Time in sec for current conv = 2.526
Truncate #19 on 22736 points by 12 bits
Conv2DCSF 41 called N=1, H=14, W=14, CI=116, FH=1, FW=1, CO=116, S=1
Time in sec for current conv = 0.431
Relu #49 on 22736 points, truncate=1 by 12 bits
Time in sec for current relu = 0.195
Conv2DCSF 42 called N=1, H=16, W=16, CI=232, FH=3, FW=3, CO=232, S=2
Time in sec for current conv = 4.164
Truncate #20 on 11368 points by 12 bits
Conv2DCSF 43 called N=1, H=7, W=7, CI=232, FH=1, FW=1, CO=232, S=1
Time in sec for current conv = 0.716
Conv2DCSF 44 called N=1, H=14, W=14, CI=232, FH=1, FW=1, CO=232, S=1
Time in sec for current conv = 1.362
Relu #51 on 45472 points, truncate=1 by 12 bits
Time in sec for current relu = 0.352
Conv2DCSF 45 called N=1, H=16, W=16, CI=232, FH=3, FW=3, CO=232, S=2
Time in sec for current conv = 4.179
Truncate #21 on 11368 points by 12 bits
Conv2DCSF 46 called N=1, H=7, W=7, CI=232, FH=1, FW=1, CO=232, S=1
Time in sec for current conv = 0.711
Truncate #22 on 11368 points by 12 bits
Truncate #23 on 11368 points by 12 bits
Relu #53 on 22736 points, truncate=0 by 0 bits
Time in sec for current relu = 0.183
Conv2DCSF 47 called N=1, H=7, W=7, CI=232, FH=1, FW=1, CO=232, S=1
Time in sec for current conv = 0.706
Relu #55 on 11368 points, truncate=1 by 12 bits
Time in sec for current relu = 0.108
Conv2DCSF 48 called N=1, H=9, W=9, CI=232, FH=3, FW=3, CO=232, S=1
Time in sec for current conv = 5.163
Truncate #24 on 11368 points by 12 bits
Conv2DCSF 49 called N=1, H=7, W=7, CI=232, FH=1, FW=1, CO=232, S=1
Time in sec for current conv = 0.713
Relu #57 on 11368 points, truncate=1 by 12 bits
Time in sec for current relu = 0.101
Conv2DCSF 50 called N=1, H=7, W=7, CI=232, FH=1, FW=1, CO=232, S=1
Time in sec for current conv = 0.703
Relu #59 on 11368 points, truncate=1 by 12 bits
Time in sec for current relu = 0.106
Conv2DCSF 51 called N=1, H=9, W=9, CI=232, FH=3, FW=3, CO=232, S=1
Time in sec for current conv = 4.983
Truncate #25 on 11368 points by 12 bits
Conv2DCSF 52 called N=1, H=7, W=7, CI=232, FH=1, FW=1, CO=232, S=1
Time in sec for current conv = 0.721
Relu #61 on 11368 points, truncate=1 by 12 bits
Time in sec for current relu = 0.107
Conv2DCSF 53 called N=1, H=7, W=7, CI=232, FH=1, FW=1, CO=232, S=1
Time in sec for current conv = 0.713
Relu #63 on 11368 points, truncate=1 by 12 bits
Time in sec for current relu = 0.108
Conv2DCSF 54 called N=1, H=9, W=9, CI=232, FH=3, FW=3, CO=232, S=1
Time in sec for current conv = 4.996
Truncate #26 on 11368 points by 12 bits
Conv2DCSF 55 called N=1, H=7, W=7, CI=232, FH=1, FW=1, CO=232, S=1
Time in sec for current conv = 0.709
Relu #65 on 11368 points, truncate=1 by 12 bits
Time in sec for current relu = 0.107
Conv2DCSF 56 called N=1, H=7, W=7, CI=464, FH=1, FW=1, CO=1024, S=1
Time in sec for current conv = 3.822
Relu #67 on 50176 points, truncate=1 by 12 bits
Time in sec for current relu = 0.398
AvgPool 1 called N=1, H=1, W=1, C=1024, ksizeH=7, ksizeW=7
Time in sec for current avgpool = 0.022
Matmul called s1,s2,s3 = 1 1024 3
Time in sec for current matmul = 0.027
Truncate #27 on 3 points by 12 bits
Elapsed wall time: 153.568 seconds
Elapsed CPU time: 368.8 seconds
CPU usage: 60.0385 %
Test end computation
Elapsed time: 153.86 seconds
Estimated energy used: 184750 joules
Thread i = 0, total data sent till now = 214288526
Thread i = 1, total data sent till now = 931989346
Thread i = 2, total data sent till now = 139237985
Thread i = 3, total data sent till now = 932357106
------------------------------------------------------
------------------------------------------------------
------------------------------------------------------
Total time taken = 127217 milliseconds.
Total data sent = 2114.23 MiB.
Number of rounds = 2418
Total comm (sent+received) = 4631.84 MiB.
------------------------------------------------------
Total time in Conv = 94.827 seconds.
Total time in MatMul = 0.027 seconds.
Total time in BatchNorm = 0.154 seconds.
Total time in Truncation = 15.12 seconds.
Total time in Relu = 12.24 seconds.
Total time in MaxPool = 4.649 seconds.
Total time in AvgPool = 0.022 seconds.
Total time in ArgMax = 0 seconds.
Total time in MatAdd = 0 seconds.
Total time in MatAddBroadCast = 0 seconds.
Total time in MulCir = 0 seconds.
Total time in ScalarMul = 0 seconds.
Total time in Sigmoid = 0 seconds.
Total time in Tanh = 0 seconds.
Total time in Sqrt = 0 seconds.
Total time in NormaliseL2 = 0 seconds.
------------------------------------------------------
Conv data sent = 69.0505 MiB.
MatMul data sent = 0.125122 MiB.
BatchNorm data sent = 2.37732 MiB.
Truncation data sent = 984.189 MiB.
Relu data sent = 737.457 MiB.
Maxpool data sent = 319.908 MiB.
Avgpool data sent = 1.12732 MiB.
ArgMax data sent = 0 MiB.
MatAdd data sent = 0 MiB.
MatAddBroadCast data sent = 0 MiB.
MulCir data sent = 0 MiB.
Sigmoid data sent = 0 MiB.
Tanh data sent = 0 MiB.
Sqrt data sent = 0 MiB.
NormaliseL2 data sent = 0 MiB.
------------------------------------------------------
Conv data (sent+received) = 536.725 MiB.
MatMul data (sent+received) = 0.50025 MiB.
BatchNorm data (sent+received) = 9.50476 MiB.
Truncation data (sent+received) = 1968.1 MiB.
Relu data (sent+received) = 1474.94 MiB.
Maxpool data (sent+received) = 639.816 MiB.
Avgpool data (sent+received) = 2.25464 MiB.
ArgMax data (sent+received) = 0 MiB.
MatAdd data (sent+received) = 0 MiB.
MatAddBroadCast data (sent+received) = 0 MiB.
MulCir data (sent+received) = 0 MiB.
ScalarMul data (sent+received) = 0 MiB.
Sigmoid data (sent+received) = 0 MiB.
Tanh data (sent+received) = 0 MiB.
Sqrt data (sent+received) = 0 MiB.
NormaliseL2 data (sent+received) = 0 MiB.
0
0
0
